export interface Vendor {
  id: string;
  name: string;
  created_at: string;
  updated_at: string;
}

export interface Product {
  id: string;
  name: string;
  vendor_id: string;
  created_at: string;
  updated_at: string;
  vendor?: Vendor;
}

export interface Vulnerability {
  id: string;
  cve_id: string;
  vendor_id: string;
  product_id: string;
  vulnerability_name: string;
  date_added: string;
  short_description: string;
  required_action: string;
  due_date: string | null;
  known_ransomware_use: boolean;
  notes: string | null;
  extra_metadata: Record<string, any> | null;
  created_at: string;
  updated_at: string;
  vendor: Vendor;
  product: Product;
}

export interface VulnerabilityListResponse {
  items: Vulnerability[];
  total: number;
  page: number;
  per_page: number;
  pages: number;
}

export interface VulnerabilitySearchRequest {
  query?: string;
  vendor?: string;
  product?: string;
  cve_id?: string;
  ransomware_only?: boolean;
  date_from?: string;
  date_to?: string;
  page: number;
  per_page: number;
}

export interface VulnerabilityStats {
  total_vulnerabilities: number;
  total_vendors: number;
  total_products: number;
  ransomware_vulnerabilities: number;
  recent_additions: number;
  by_vendor: Array<{
    name: string;
    count: number;
  }>;
  by_month: Array<{
    month: string;
    count: number;
  }>;
}

export interface DataSyncStatus {
  id: string;
  source: string;
  status: string;
  last_sync_at: string | null;
  total_records: number | null;
  processed_records: number | null;
  error_message: string | null;
  catalog_version: string | null;
  date_released: string | null;
  created_at: string;
  updated_at: string;
}